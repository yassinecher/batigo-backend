<div class="container">
    <h1>Gestion des Livraisons</h1>

    <!-- Toggle the form visibility -->
    <button (click)="toggleForm()">{{ showForm ? 'Hide Form' : 'Add New Livraison' }}</button>

    <!-- Display List of Livraisons -->
    <table border="1" width="100%" cellspacing="0" cellpadding="8" style="margin-top: 20px;">
        <thead>
            <tr>
                <th>ID</th>
                <th>Status</th>
                <th>Order Date</th>
                <th>Commande ID</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let liv of livraisons">
                <td>{{ liv.id }}</td>
                <td>{{ liv.statusl }}</td>
                <td>{{ liv.orderdate | date: 'short' }}</td>  <!-- Format the date to a readable form -->
                <td>{{ liv.commande?.idcommande }}</td>
                <td>
                    <button (click)="editLivraison(liv)">Edit</button>
                    <button (click)="deleteLivraison(liv.id)">Delete</button>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Form for Adding or Updating a Livraison -->
    <div class="form-container" *ngIf="showForm" style="margin-top: 20px;">
        <h2>{{ isEditing ? 'Edit Livraison' : 'Add New Livraison' }}</h2>
        <form #livraisonForm="ngForm" (ngSubmit)="onSubmit()">

            <!-- Status Field -->
            <div>
                <label for="statusl">Status:</label>
                <select id="statusl" name="statusl" [(ngModel)]="livraison.statusl" required>
                    <option value="Shipped">Shipped</option>
                    <option value="Delivered">Delivered</option>
                    <option value="Returned">Returned</option>
                </select>
            </div>

            <!-- Order Date Field -->
            <div>
                <label for="orderdate">Order Date:</label>
                <input 
                    type="datetime-local" 
                    id="orderdate" 
                    name="orderdate" 
                    [(ngModel)]="livraison.orderdate" 
                    required>
            </div>

            <!-- Commande ID Field -->
            <div>
                <label for="idcommande">Commande ID:</label>
                <select 
                    id="idcommande" 
                    name="idcommande" 
                    [(ngModel)]="livraison.commande.idcommande" 
                    required>
                    <option *ngFor="let cmd of commandes" [value]="cmd.idcommande">
                        {{ cmd.idcommande }}
                    </option>
                </select>
            </div>

            <!-- Form Actions -->
            <button type="submit">{{ isEditing ? 'Update' : 'Add' }} Livraison</button>
            <button type="button" (click)="cancelForm()">Cancel</button>
        </form>
    </div>
</div>
